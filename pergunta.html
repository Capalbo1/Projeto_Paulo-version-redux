<!doctype html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Pergunta</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="shortcut icon" href="assets/imagens/icons8-teste-96.png" type="image/x-icon">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- CSS -->
  <link rel="stylesheet" href="assets/css/app.css?v=13">
  <link rel="stylesheet" href="assets/css/resultado.css?v=2">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- JS -->
  <script defer src="assets/js/app.js?v=3"></script>
</head>
<body>
<header class="site-header">
  <div class="nav">
    <a class="brand" href="index.html">
      <img src="assets/imagens/logo_disc.png" alt="DISC" class="brand-img">
    </a>

    <nav class="links">
      <a href="index.html" class="nav-home">InÃ­cio</a>
      <a href="index.html#sobre">Sobre</a>
      <a href="index.html#professor">Desenvolvedor</a>
      <a href="index.html#politica">PolÃ­tica</a>
      <a class="button primary" href="consentimento.html">ComeÃ§ar</a>

      <div class="theme-switch">
        <span class="theme-label">Tema</span>
        <button class="theme-toggle" id="themeToggle" type="button" aria-label="Alternar tema">ðŸŒ—</button>
      </div>
    </nav>
  </div>
</header>

<main class="container">
  <section class="card">
    <div class="progress">
      <div id="progress-bar" class="bar" style="width:0%"></div>
    </div>
    <h2 id="pergunta-titulo">Pergunta</h2>
    <p id="pergunta-texto" class="qtext"></p>

    <form id="form-pergunta" class="form">
      <div id="opcoes"></div>
      <button class="button primary" type="submit">PrÃ³xima</button>
    </form>
  </section>
</main>

<footer class="site-footer">
  <div>
    <span>Â© CRV SoluÃ§Ãµes em T.I</span>
    <span class="sep">Â·</span>
    <span>Teste DISC adaptado pelo Prof. Me. Paulo Rubens Rocha Albino</span>
  </div>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const perguntas = window.DISC_QUESTOES || [];
  let atual = parseInt(localStorage.getItem("disc_pergunta_atual") || "0", 10);
  const respostas = JSON.parse(localStorage.getItem("disc_respostas") || "[]");

  if (atual >= perguntas.length) {
    // jÃ¡ respondeu tudo â†’ resultado
    window.location.href = "resultado.html";
    return;
  }

  const pergunta = perguntas[atual];
  const titulo = document.getElementById("pergunta-titulo");
  const texto = document.getElementById("pergunta-texto");
  const opcoesDiv = document.getElementById("opcoes");
  const progressBar = document.getElementById("progress-bar");

  titulo.textContent = `Pergunta ${atual + 1} de ${perguntas.length}`;
  texto.textContent = pergunta.texto;
  progressBar.style.width = `${((atual+1)/perguntas.length)*100}%`;

  // renderiza opÃ§Ãµes
  opcoesDiv.innerHTML = "";
  pergunta.opcoes.forEach((opt, idx) => {
    const label = document.createElement("label");
    label.className = "option";
    label.innerHTML = `
      <input type="radio" name="option" value="${opt.valor}">
      <span>${opt.texto}</span>
    `;
    opcoesDiv.appendChild(label);
  });

  const form = document.getElementById("form-pergunta");
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    const selecionado = form.querySelector("input[name=option]:checked");
    if (!selecionado) {
      alert("Selecione uma alternativa para continuar.");
      return;
    }

    respostas.push(selecionado.value);
    localStorage.setItem("disc_respostas", JSON.stringify(respostas));
    localStorage.setItem("disc_pergunta_atual", atual + 1);

    if (atual + 1 >= perguntas.length) {
      window.location.href = "resultado.html";
    } else {
      window.location.href = "pergunta.html";
    }
  });
});
</script>
</body>
</html>
